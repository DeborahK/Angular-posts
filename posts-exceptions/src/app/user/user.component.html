<div class="container">
  <h2>Select a User</h2>
  <div *ngIf='users$ | async as users'>
    <select class="form-select form-select-lg form-control"
            (change)="onSelected($any($event.target).value)">
      <option value="">--Select a user--</option>
      <option *ngFor="let user of users"
              [value]="user.id">{{ user.name }}</option>
    </select>
  </div>

  <ng-container *ngIf="{selectedUser: selectedUser$ | async, 
    todos: todos$ | async} as userInfo">
    <div *ngIf="userInfo.selectedUser && userInfo.todos">
      <table class="table">
        <caption style="font-weight: bold;text-align: left;">User: {{userInfo.selectedUser.name}}</caption>
        <thead>
          <tr>
            <th>Task Title</th>
            <th>Completed?</th>
          </tr>
        </thead>
        <tbody *ngFor="let todo of userInfo.todos">
          <tr>
            <td>{{ todo.title }}</td>
            <td>{{ todo.completed }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>

  <br>
  <h2>All Users with their ToDos</h2>
    <table class="table caption-top" *ngFor="let userData of usersWithTodos$ | async">
      <caption class="fs-2">User: {{userData.user.name}}</caption>
      <thead>
        <tr>
          <th>Task Title</th>
          <th>Completed?</th>
        </tr>
      </thead>
      <tbody *ngFor="let todo of userData.todos">
        <tr>
          <td>{{ todo.title }}</td>
          <td>{{ todo.completed }}</td>
        </tr>
      </tbody>
    </table>
</div>